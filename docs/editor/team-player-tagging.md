# íŒ€/ì„ ìˆ˜ íƒœê·¸ ê¸°ëŠ¥ ì„¤ê³„ ë¬¸ì„œ

## ê°œìš”

ê²Œì‹œê¸€ ì‘ì„± ì‹œ íˆ´ë°” ë²„íŠ¼ì„ í†µí•´ íŒ€/ì„ ìˆ˜ë¥¼ ë‹¨ê³„ë³„ë¡œ ì„ íƒí•˜ê³ , ì¹´ë“œ í˜•íƒœë¡œ ì‚½ì…ë˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

### ì‚¬ìš©ì ê²½í—˜ (UX)

#### íŒ€ ì„ íƒ íë¦„
```
1. íˆ´ë°”ì—ì„œ "íŒ€/ì„ ìˆ˜" ë²„íŠ¼ í´ë¦­ â†’ [íŒ€] íƒ­ ì„ íƒ
2. ë¦¬ê·¸ ì„ íƒ (EPL, ë¼ë¦¬ê°€, ë¶„ë°ìŠ¤ë¦¬ê°€, ì„¸ë¦¬ì—A, ë¦¬ê·¸1)
3. í•´ë‹¹ ë¦¬ê·¸ì˜ íŒ€ ëª©ë¡ì—ì„œ íŒ€ ì„ íƒ
4. íŒ€ ì¹´ë“œê°€ ì—ë””í„°ì— ì‚½ì…ë¨
```

#### ì„ ìˆ˜ ì„ íƒ íë¦„
```
1. íˆ´ë°”ì—ì„œ "íŒ€/ì„ ìˆ˜" ë²„íŠ¼ í´ë¦­ â†’ [ì„ ìˆ˜] íƒ­ ì„ íƒ
2. ë¦¬ê·¸ ì„ íƒ
3. íŒ€ ì„ íƒ
4. í•´ë‹¹ íŒ€ì˜ ì„ ìˆ˜ ëª©ë¡ì—ì„œ ì„ ìˆ˜ ì„ íƒ
5. ì„ ìˆ˜ ì¹´ë“œê°€ ì—ë””í„°ì— ì‚½ì…ë¨
```

**UI ì˜ˆì‹œ:**
```
[íˆ´ë°”] ... | ğŸŸï¸ ê²½ê¸° | ğŸ‘¥ íŒ€/ì„ ìˆ˜ | ...
                           â†“ í´ë¦­

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [íŒ€] [ì„ ìˆ˜]                          â”‚  â† íƒ­
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  Step 1: ë¦¬ê·¸ ì„ íƒ                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ EPL â”‚ â”‚ë¼ë¦¬ê°€â”‚ â”‚ë¶„ë°ìŠ¤â”‚ â”‚ì„¸ë¦¬ì—â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  Step 2: íŒ€ ì„ íƒ (EPL ì„ íƒ ì‹œ)       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ğŸ”µ   â”‚ â”‚ğŸ”µ   â”‚ â”‚ğŸ”´   â”‚ â”‚ğŸ”µ   â”‚   â”‚
â”‚  â”‚í† íŠ¸ë„˜â”‚ â”‚ë§¨ì‹œí‹°â”‚ â”‚ë¦¬ë²„í’€â”‚ â”‚ì²¼ì‹œ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì„ íƒ ì‹œ ì—ë””í„°ì— ì‚½ì…:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      (ğŸ”µ)       â”‚  â† ì›í˜• ë¡œê³ /ì‚¬ì§„
â”‚    í† íŠ¸ë„˜        â”‚  â† ì´ë¦„ (ì¤‘ì•™)
â”‚ í”„ë¦¬ë¯¸ì–´ë¦¬ê·¸     â”‚  â† ë¶€ì œëª© (ì¤‘ì•™)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## êµ¬í˜„ ë°©ì‹: íˆ´ë°” ë²„íŠ¼ ë°©ì‹

ê¸°ì¡´ "ê²½ê¸° ë¶ˆëŸ¬ì˜¤ê¸°" ê¸°ëŠ¥(`MatchResultForm`)ê³¼ ë™ì¼í•œ íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„í•©ë‹ˆë‹¤.

### ë¹„êµ: ê¸°ì¡´ @ ë©˜ì…˜ ë°©ì‹ vs ìƒˆ íˆ´ë°” ë°©ì‹

| í•­ëª© | @ ë©˜ì…˜ ë°©ì‹ (ì œê±°ë¨) | íˆ´ë°” ë²„íŠ¼ ë°©ì‹ (ì ìš©) |
|------|---------------------|----------------------|
| íŠ¸ë¦¬ê±° | ì—ë””í„°ì—ì„œ `@` ì…ë ¥ | íˆ´ë°” ë²„íŠ¼ í´ë¦­ |
| UI | ì¸ë¼ì¸ ë“œë¡­ë‹¤ìš´ | ëª¨ë‹¬ ë‹¤ì´ì–¼ë¡œê·¸ |
| ì‚¬ìš©ì„± | í…ìŠ¤íŠ¸ ì…ë ¥ ì¤‘ ìì—°ìŠ¤ëŸ¬ì›€ | ëª…í™•í•œ ì•¡ì…˜, íƒ­ìœ¼ë¡œ êµ¬ë¶„ |
| ê²€ìƒ‰ ë²”ìœ„ | íŒ€+ì„ ìˆ˜ í†µí•© ê²€ìƒ‰ | íƒ­ìœ¼ë¡œ íŒ€/ì„ ìˆ˜ ë¶„ë¦¬ |
| êµ¬í˜„ ë³µì¡ë„ | ë†’ìŒ (Tiptap suggestion API) | ë‚®ìŒ (ëª¨ë‹¬ + ë²„íŠ¼) |

---

## ê¸°ì¡´ êµ¬ì¡° ë¶„ì„

### 1. ê²½ê¸° ì¹´ë“œ ì‹œìŠ¤í…œ (ì°¸ê³ ìš©)

| í•­ëª© | íŒŒì¼ ìœ„ì¹˜ |
|------|----------|
| Tiptap í™•ì¥ | `src/shared/ui/tiptap/MatchCardExtension.ts` |
| ë…¸ë“œ ì»´í¬ë„ŒíŠ¸ | `src/domains/boards/components/match/MatchCardNode.tsx` |
| ì¹´ë“œ ì»´í¬ë„ŒíŠ¸ | `src/domains/boards/components/match/MatchCard.tsx` |
| ì„ íƒ í¼ | `src/domains/boards/components/match/MatchResultForm.tsx` |
| ë Œë”ëŸ¬ | `src/domains/boards/components/post/post-content/renderers/matchCardRenderer.ts` |

**í•µì‹¬ íŒ¨í„´:**
```typescript
// íˆ´ë°” ë²„íŠ¼ í´ë¦­ â†’ ëª¨ë‹¬ ì—´ê¸° â†’ í•­ëª© ì„ íƒ â†’ ì¹´ë“œ ì‚½ì…
const handleMatchSelect = (match: MatchData) => {
  editor.commands.setMatchCard(match.id, match);
  setShowMatchModal(false);
};
```

### 2. ë°ì´í„° ì†ŒìŠ¤

#### íŒ€ ë°ì´í„°
- **DB í…Œì´ë¸”**: `football_teams`
- **í•œê¸€ ë§¤í•‘**: `src/domains/livescore/constants/teams/index.ts`
- **ê²€ìƒ‰ API**: `src/domains/search/actions/searchTeams.ts` âœ…

#### ì„ ìˆ˜ ë°ì´í„°
- **DB í…Œì´ë¸”**: `football_players`
- **í•œê¸€ ë§¤í•‘**: `src/domains/livescore/constants/players/index.ts`
- **ê²€ìƒ‰ API**: `src/domains/search/actions/searchPlayers.ts` âœ…

---

## êµ¬í˜„ ê³„íš

### Phase 1: ë°ì´í„° ë ˆì´ì–´ (ê¸°ì¡´ í•¨ìˆ˜ ì¬ì‚¬ìš© âœ…)

#### 1.1 ë¦¬ê·¸ë³„ íŒ€ ëª©ë¡ ì¡°íšŒ (ê¸°ì¡´ í•¨ìˆ˜ ì‚¬ìš©)

**íŒŒì¼:** `src/domains/livescore/constants/teams/index.ts` âœ…

```typescript
import { getTeamsByLeagueId } from '@/domains/livescore/constants/teams'

// í”„ë¦¬ë¯¸ì–´ë¦¬ê·¸(39) íŒ€ ì¡°íšŒ
const premierTeams = getTeamsByLeagueId(39)
// [ { id: 33, name_ko: 'ë§¨ìœ ', name_en: 'Manchester United', logo: '...', ... } ]

// ì§€ì› ë¦¬ê·¸: EPL(39), ë¼ë¦¬ê°€(140), ë¶„ë°ìŠ¤(78), ì„¸ë¦¬ì—A(135), ë¦¬ê·¸1(61) ë“± 15ê°œ ë¦¬ê·¸
```

**TeamMapping íƒ€ì…:**
```typescript
interface TeamMapping {
  id: number
  name_ko: string
  name_en: string
  country_ko: string
  country_en: string
  code: string
  logo: string
}
```

#### 1.2 íŒ€ë³„ ì„ ìˆ˜ ëª©ë¡ ì¡°íšŒ (ê¸°ì¡´ í•¨ìˆ˜ ì‚¬ìš©)

**íŒŒì¼:** `src/domains/livescore/actions/teams/squad.ts` âœ…

```typescript
import { fetchTeamSquad } from '@/domains/livescore/actions/teams/squad'

const squad = await fetchTeamSquad('33') // íŒ€ ID (ë¬¸ìì—´)
// { success: true, data: [
//   { id: 18, name: 'Bruno Fernandes', position: 'Midfielder', number: 8, photo: '...' }
// ]}
```

**Player íƒ€ì…:**
```typescript
interface Player {
  id: number
  name: string
  age: number
  number: number | null
  position: string
  photo: string
}
```

#### 1.3 ê´€ë ¨ ìƒìˆ˜/ìœ í‹¸

**ë¦¬ê·¸ ëª©ë¡:** `src/domains/search/constants/leagues.ts`
```typescript
export const ALLOWED_LEAGUE_IDS = [39, 140, 78, 135, 61, ...]
```

**ì„ ìˆ˜ í•œê¸€ ì´ë¦„:** `src/domains/livescore/constants/players/index.ts`
```typescript
import { getPlayerById } from '@/domains/livescore/constants/players'

const player = getPlayerById(306) // ì†í¥ë¯¼
// { id: 306, name_ko: 'ì†í¥ë¯¼', name_en: 'Son Heung-Min', team_id: 47, ... }
```

### Phase 2: Tiptap í™•ì¥ (ì™„ë£Œ âœ…)

#### 2.1 TeamCardExtension

**íŒŒì¼:** `src/shared/ui/tiptap/TeamCardExtension.ts` âœ…

```typescript
export const TeamCardExtension = Node.create({
  name: 'teamCard',
  group: 'block',
  atom: true,
  draggable: true,

  addCommands() {
    return {
      setTeamCard: (teamId, teamData) => ({ commands }) => {
        return commands.insertContent({
          type: this.name,
          attrs: { teamId, teamData }
        });
      }
    };
  }
});
```

#### 2.2 PlayerCardExtension

**íŒŒì¼:** `src/shared/ui/tiptap/PlayerCardExtension.ts` âœ…

ë™ì¼í•œ íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„.

### Phase 3: UI ì»´í¬ë„ŒíŠ¸

#### 3.1 EntityPickerForm (ì‹ ê·œ í•„ìš”)

**íŒŒì¼:** `src/domains/boards/components/entity/EntityPickerForm.tsx`

```typescript
interface EntityPickerFormProps {
  isOpen: boolean
  onClose: () => void
  onSelectTeam: (team: TeamCardData) => void
  onSelectPlayer: (player: PlayerCardData) => void
}

// ì§€ì› ë¦¬ê·¸ ëª©ë¡
const LEAGUES = [
  { id: 39, name: 'í”„ë¦¬ë¯¸ì–´ë¦¬ê·¸', logo: '...' },
  { id: 140, name: 'ë¼ë¦¬ê°€', logo: '...' },
  { id: 78, name: 'ë¶„ë°ìŠ¤ë¦¬ê°€', logo: '...' },
  { id: 135, name: 'ì„¸ë¦¬ì—A', logo: '...' },
  { id: 61, name: 'ë¦¬ê·¸1', logo: '...' },
]

export function EntityPickerForm({ isOpen, onClose, onSelectTeam, onSelectPlayer }: EntityPickerFormProps) {
  const [activeTab, setActiveTab] = useState<'team' | 'player'>('team')

  // ë‹¨ê³„ë³„ ì„ íƒ ìƒíƒœ
  const [selectedLeagueId, setSelectedLeagueId] = useState<number | null>(null)
  const [selectedTeamId, setSelectedTeamId] = useState<number | null>(null)

  // ë°ì´í„°
  const [teams, setTeams] = useState<TeamCardData[]>([])
  const [players, setPlayers] = useState<PlayerCardData[]>([])

  // ë¦¬ê·¸ ì„ íƒ ì‹œ â†’ íŒ€ ëª©ë¡ ë¡œë“œ
  useEffect(() => {
    if (selectedLeagueId) {
      loadTeamsByLeague(selectedLeagueId).then(setTeams)
    }
  }, [selectedLeagueId])

  // íŒ€ ì„ íƒ ì‹œ â†’ ì„ ìˆ˜ ëª©ë¡ ë¡œë“œ (ì„ ìˆ˜ íƒ­ì¼ ë•Œë§Œ)
  useEffect(() => {
    if (activeTab === 'player' && selectedTeamId) {
      loadPlayersByTeam(selectedTeamId).then(setPlayers)
    }
  }, [activeTab, selectedTeamId])

  // ë’¤ë¡œê°€ê¸°
  const handleBack = () => {
    if (selectedTeamId) {
      setSelectedTeamId(null)
      setPlayers([])
    } else if (selectedLeagueId) {
      setSelectedLeagueId(null)
      setTeams([])
    }
  }

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="max-w-lg">
        {/* í—¤ë” */}
        <div className="flex items-center gap-2">
          {(selectedLeagueId || selectedTeamId) && (
            <button onClick={handleBack}>â† ë’¤ë¡œ</button>
          )}
          <Tabs value={activeTab} onValueChange={setActiveTab}>
            <TabsList>
              <TabsTrigger value="team">íŒ€</TabsTrigger>
              <TabsTrigger value="player">ì„ ìˆ˜</TabsTrigger>
            </TabsList>
          </Tabs>
        </div>

        {/* Step 1: ë¦¬ê·¸ ì„ íƒ */}
        {!selectedLeagueId && (
          <div>
            <h3 className="text-sm font-medium mb-3">ë¦¬ê·¸ ì„ íƒ</h3>
            <div className="grid grid-cols-5 gap-2">
              {LEAGUES.map(league => (
                <button
                  key={league.id}
                  onClick={() => setSelectedLeagueId(league.id)}
                  className="flex flex-col items-center p-3 rounded-lg hover:bg-gray-100"
                >
                  <img src={league.logo} className="w-10 h-10" />
                  <span className="text-xs mt-1">{league.name}</span>
                </button>
              ))}
            </div>
          </div>
        )}

        {/* Step 2: íŒ€ ì„ íƒ */}
        {selectedLeagueId && !selectedTeamId && (
          <div>
            <h3 className="text-sm font-medium mb-3">íŒ€ ì„ íƒ</h3>
            <div className="grid grid-cols-4 gap-3 max-h-80 overflow-y-auto">
              {teams.map(team => (
                <button
                  key={team.id}
                  onClick={() => {
                    if (activeTab === 'team') {
                      onSelectTeam(team)
                      onClose()
                    } else {
                      setSelectedTeamId(team.id)
                    }
                  }}
                  className="flex flex-col items-center p-3 rounded-lg hover:bg-gray-100"
                >
                  <img src={team.logo} className="w-12 h-12" />
                  <span className="text-xs mt-1 text-center">{team.koreanName || team.name}</span>
                </button>
              ))}
            </div>
          </div>
        )}

        {/* Step 3: ì„ ìˆ˜ ì„ íƒ (ì„ ìˆ˜ íƒ­ì—ì„œë§Œ) */}
        {activeTab === 'player' && selectedTeamId && (
          <div>
            <h3 className="text-sm font-medium mb-3">ì„ ìˆ˜ ì„ íƒ</h3>
            <div className="grid grid-cols-4 gap-3 max-h-80 overflow-y-auto">
              {players.map(player => (
                <button
                  key={player.id}
                  onClick={() => {
                    onSelectPlayer(player)
                    onClose()
                  }}
                  className="flex flex-col items-center p-3 rounded-lg hover:bg-gray-100"
                >
                  <img src={player.photo} className="w-12 h-12 rounded-full" />
                  <span className="text-xs mt-1 text-center">{player.koreanName || player.name}</span>
                  <span className="text-xs text-gray-500">{player.position}</span>
                </button>
              ))}
            </div>
          </div>
        )}
      </DialogContent>
    </Dialog>
  )
}
```

#### 3.2 ì¹´ë“œ UI (UnifiedSportsImage ì‚¬ìš©)

**ì°¸ê³ :** `PlayerStatsModal.tsx`ì˜ ì´ë¯¸ì§€ ì²˜ë¦¬ ë°©ì‹ì„ ë”°ë¦„

```typescript
import { UnifiedSportsImage, ImageType } from '@/shared/components/UnifiedSportsImage'

// íŒ€ ì¹´ë“œ - UnifiedSportsImage ì‚¬ìš©
function SimpleTeamCard({ team }: { team: TeamMapping }) {
  return (
    <Link
      href={`/livescore/football/team/${team.id}`}
      className="inline-flex flex-col items-center p-4 bg-white dark:bg-[#1D1D1D] rounded-xl border border-black/7 dark:border-0 hover:bg-[#EAEAEA] dark:hover:bg-[#333333] transition-colors"
    >
      <UnifiedSportsImage
        imageId={team.id}
        imageType={ImageType.Teams}
        alt={team.name_ko}
        size="xl"  // w-12 h-12
        variant="square"
        fit="contain"
      />
      <span className="mt-2 font-semibold text-sm text-center text-gray-900 dark:text-[#F0F0F0]">
        {team.name_ko}
      </span>
      <span className="text-xs text-gray-500 dark:text-gray-400 text-center">
        {getLeagueName(team.id)}
      </span>
    </Link>
  )
}

// ì„ ìˆ˜ ì¹´ë“œ - PlayerStatsModal ìŠ¤íƒ€ì¼ ì°¸ê³ 
function SimplePlayerCard({ player, teamId }: { player: Player; teamId: number }) {
  const playerMapping = getPlayerById(player.id)  // í•œê¸€ ì´ë¦„ ì¡°íšŒ

  return (
    <Link
      href={`/livescore/football/player/${player.id}`}
      className="inline-flex flex-col items-center p-4 bg-white dark:bg-[#1D1D1D] rounded-xl border border-black/7 dark:border-0 hover:bg-[#EAEAEA] dark:hover:bg-[#333333] transition-colors"
    >
      {/* ì›í˜• ì´ë¯¸ì§€ + íŒ€ ë¡œê³  ë±ƒì§€ (PlayerStatsModal ìŠ¤íƒ€ì¼) */}
      <div className="relative">
        <div className="w-16 h-16 rounded-full border-2 border-white dark:border-[#1D1D1D] shadow-md overflow-hidden">
          <UnifiedSportsImage
            imageId={player.id}
            imageType={ImageType.Players}
            alt={player.name}
            size="xl"
            variant="circle"
            className="w-full h-full"
          />
        </div>
        {/* íŒ€ ë¡œê³  ë±ƒì§€ */}
        <div className="absolute -bottom-1 -right-1 w-6 h-6 rounded-full bg-white dark:bg-[#1D1D1D] shadow flex items-center justify-center">
          <UnifiedSportsImage
            imageId={teamId}
            imageType={ImageType.Teams}
            alt="íŒ€ ë¡œê³ "
            size="sm"
            variant="square"
            fit="contain"
            className="w-4 h-4"
          />
        </div>
      </div>

      <span className="mt-2 font-semibold text-sm text-center text-gray-900 dark:text-[#F0F0F0]">
        {playerMapping?.name_ko || player.name}
      </span>
      <span className="text-xs text-gray-500 dark:text-gray-400 text-center">
        {player.position}
        {player.number && ` Â· #${player.number}`}
      </span>
    </Link>
  )
}
```

**UnifiedSportsImage ì‚¬ì´ì¦ˆ:**
| size | í¬ê¸° |
|------|------|
| sm | w-6 h-6 |
| md | w-8 h-8 |
| lg | w-10 h-10 |
| xl | w-12 h-12 |
| xxl | w-28 h-28 |

### Phase 4: ì—ë””í„° í†µí•©

#### 4.1 PostEditForm ìˆ˜ì •

**íŒŒì¼:** `src/domains/boards/components/post/PostEditForm.tsx`

```typescript
// ìƒíƒœ ì¶”ê°€
const [showEntityPicker, setShowEntityPicker] = useState(false)

// íˆ´ë°” ë²„íŠ¼ ì¶”ê°€ (ê²½ê¸° ë¶ˆëŸ¬ì˜¤ê¸° ë²„íŠ¼ ì˜†ì—)
<button
  onClick={() => setShowEntityPicker(true)}
  className="toolbar-button"
>
  ğŸ‘¥ íŒ€/ì„ ìˆ˜
</button>

// ì¹´ë“œ ì‚½ì… í•¸ë“¤ëŸ¬
const handleTeamSelect = (team: TeamCardData) => {
  editor?.commands.setTeamCard(team.id, team)
  setShowEntityPicker(false)
}

const handlePlayerSelect = (player: PlayerCardData) => {
  editor?.commands.setPlayerCard(player.id, player)
  setShowEntityPicker(false)
}

// ëª¨ë‹¬ ë Œë”ë§
<EntityPickerForm
  isOpen={showEntityPicker}
  onClose={() => setShowEntityPicker(false)}
  onSelectTeam={handleTeamSelect}
  onSelectPlayer={handlePlayerSelect}
/>
```

### Phase 5: ë Œë”ë§ ì‹œìŠ¤í…œ (ì™„ë£Œ âœ…)

**íŒŒì¼:** `src/domains/boards/components/post/post-content/renderers/tipTapRenderer.ts` âœ…

íŒ€/ì„ ìˆ˜ ì¹´ë“œ ë Œë”ë§ ì´ë¯¸ ì¶”ê°€ë¨.

---

## íŒŒì¼ êµ¬ì¡°

```
src/
â”œâ”€â”€ domains/
â”‚   â”œâ”€â”€ boards/
â”‚   â”‚   â””â”€â”€ components/
â”‚   â”‚       â”œâ”€â”€ cards/
â”‚   â”‚       â”‚   â”œâ”€â”€ TeamCard.tsx          # íŒ€ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸ âœ…
â”‚   â”‚       â”‚   â”œâ”€â”€ TeamCardNode.tsx      # Tiptap ë…¸ë“œ ë˜í¼ âœ…
â”‚   â”‚       â”‚   â”œâ”€â”€ PlayerCard.tsx        # ì„ ìˆ˜ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸ âœ…
â”‚   â”‚       â”‚   â””â”€â”€ PlayerCardNode.tsx    # Tiptap ë…¸ë“œ ë˜í¼ âœ…
â”‚   â”‚       â”œâ”€â”€ entity/
â”‚   â”‚       â”‚   â””â”€â”€ EntityPickerForm.tsx  # íŒ€/ì„ ìˆ˜ ì„ íƒ ëª¨ë‹¬ (ì‹ ê·œ)
â”‚   â”‚       â””â”€â”€ post/
â”‚   â”‚           â””â”€â”€ post-content/
â”‚   â”‚               â””â”€â”€ renderers/
â”‚   â”‚                   â”œâ”€â”€ teamCardRenderer.ts   âœ…
â”‚   â”‚                   â””â”€â”€ playerCardRenderer.ts âœ…
â”‚   â”œâ”€â”€ livescore/
â”‚   â”‚   â”œâ”€â”€ constants/
â”‚   â”‚   â”‚   â”œâ”€â”€ teams/index.ts            # getTeamsByLeagueId() âœ… (ê¸°ì¡´)
â”‚   â”‚   â”‚   â””â”€â”€ players/index.ts          # getPlayerById() âœ… (ê¸°ì¡´)
â”‚   â”‚   â””â”€â”€ actions/teams/
â”‚   â”‚       â””â”€â”€ squad.ts                  # fetchTeamSquad() âœ… (ê¸°ì¡´)
â”‚   â””â”€â”€ search/
â”‚       â””â”€â”€ actions/
â”‚           â”œâ”€â”€ searchPlayers.ts          # ì„ ìˆ˜ ê²€ìƒ‰ API âœ…
â”‚           â””â”€â”€ searchEntities.ts         # í†µí•© ê²€ìƒ‰ API âœ…
â”‚
â”œâ”€â”€ shared/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ UnifiedSportsImage.tsx        # ìŠ¤í¬ì¸  ì´ë¯¸ì§€ ì»´í¬ë„ŒíŠ¸ âœ… (ê¸°ì¡´)
â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â””â”€â”€ tiptap/
â”‚   â”‚       â”œâ”€â”€ TeamCardExtension.ts      # íŒ€ ì¹´ë“œ Tiptap í™•ì¥ âœ…
â”‚   â”‚       â””â”€â”€ PlayerCardExtension.ts    # ì„ ìˆ˜ ì¹´ë“œ Tiptap í™•ì¥ âœ…
â”‚   â””â”€â”€ types/
â”‚       â”œâ”€â”€ teamCard.ts                   # íŒ€ ì¹´ë“œ íƒ€ì… âœ…
â”‚       â””â”€â”€ playerCard.ts                 # ì„ ìˆ˜ ì¹´ë“œ íƒ€ì… âœ…
```

---

## êµ¬í˜„ ìƒíƒœ

### ì™„ë£Œë¨ âœ…
1. [x] `searchPlayers.ts` - ì„ ìˆ˜ ê²€ìƒ‰ API
2. [x] `searchEntities.ts` - í†µí•© ê²€ìƒ‰ API
3. [x] íƒ€ì… ì •ì˜ (`teamCard.ts`, `playerCard.ts`)
4. [x] `TeamCardExtension.ts` - Tiptap í™•ì¥
5. [x] `PlayerCardExtension.ts` - Tiptap í™•ì¥
6. [x] `TeamCard.tsx`, `TeamCardNode.tsx` - ì¹´ë“œ ì»´í¬ë„ŒíŠ¸
7. [x] `PlayerCard.tsx`, `PlayerCardNode.tsx` - ì¹´ë“œ ì»´í¬ë„ŒíŠ¸
8. [x] `tipTapRenderer.ts` - ë Œë”ëŸ¬ í†µí•©
9. [x] `teamCardRenderer.ts`, `playerCardRenderer.ts` - ì¹´ë“œ ë Œë”ëŸ¬
10. [x] ì¹´ë“œ ìŠ¤íƒ€ì¼ë§ (`globals.css`)

### ì‚­ì œë¨ (@ ë©˜ì…˜ ë°©ì‹)
- ~~`EntityMentionExtension.ts`~~ - ì‚­ì œë¨
- ~~`entitySuggestion.tsx`~~ - ì‚­ì œë¨
- ~~`MentionList.tsx`~~ - ì‚­ì œë¨

### êµ¬í˜„ í•„ìš” (ë‹¨ê³„ë³„ ì„ íƒ ë°©ì‹)
1. [x] ~~`getTeamsByLeague.ts`~~ - ê¸°ì¡´ í•¨ìˆ˜ ì‚¬ìš©: `getTeamsByLeagueId()`
2. [x] ~~`getPlayersByTeam.ts`~~ - ê¸°ì¡´ í•¨ìˆ˜ ì‚¬ìš©: `fetchTeamSquad()`
3. [ ] `EntityPickerForm.tsx` - íŒ€/ì„ ìˆ˜ ì„ íƒ ëª¨ë‹¬ (ë‹¨ê³„ë³„ UI)
4. [ ] `PostEditForm.tsx` - íˆ´ë°” ë²„íŠ¼ ì¶”ê°€
5. [ ] ì¹´ë“œ UI ì—…ë°ì´íŠ¸ (`UnifiedSportsImage` ì‚¬ìš©)

---

## UI ë””ìì¸ ê°€ì´ë“œ

**ì°¸ê³ :** `src/shared/components/ui/UI_GUIDELINES.md` ì¤€ìˆ˜

### ìƒ‰ìƒ ì²´ê³„ (UI_GUIDELINES ê¸°ì¤€)

| ìš©ë„ | ë¼ì´íŠ¸ ëª¨ë“œ | ë‹¤í¬ ëª¨ë“œ |
|------|------------|----------|
| ì¹´ë“œ ë°°ê²½ | `bg-white` | `dark:bg-[#1D1D1D]` |
| ì¹´ë“œ í…Œë‘ë¦¬ | `border-black/7` | `dark:border-0` |
| í˜¸ë²„ ë°°ê²½ | `hover:bg-[#EAEAEA]` | `dark:hover:bg-[#333333]` |
| ê¸°ë³¸ í…ìŠ¤íŠ¸ | `text-gray-900` | `dark:text-[#F0F0F0]` |
| ë³´ì¡° í…ìŠ¤íŠ¸ | `text-gray-500` | `dark:text-gray-400` |

### ì»´í¬ë„ŒíŠ¸ ìŠ¤íƒ€ì¼

```tsx
// ì¹´ë“œ ì»¨í…Œì´ë„ˆ (UI_GUIDELINES ì¤€ìˆ˜)
className="inline-flex flex-col items-center p-4
  bg-white dark:bg-[#1D1D1D]
  rounded-xl border border-black/7 dark:border-0
  hover:bg-[#EAEAEA] dark:hover:bg-[#333333]
  transition-colors"

// ê¸°ë³¸ í…ìŠ¤íŠ¸
className="font-semibold text-sm text-gray-900 dark:text-[#F0F0F0]"

// ë³´ì¡° í…ìŠ¤íŠ¸
className="text-xs text-gray-500 dark:text-gray-400"
```

### ì´ë¯¸ì§€ ì²˜ë¦¬ (UnifiedSportsImage)

```tsx
import { UnifiedSportsImage, ImageType } from '@/shared/components/UnifiedSportsImage'

// íŒ€ ë¡œê³ 
<UnifiedSportsImage
  imageId={teamId}
  imageType={ImageType.Teams}
  size="xl"
  variant="square"
  fit="contain"
/>

// ì„ ìˆ˜ ì‚¬ì§„ (ì›í˜•)
<UnifiedSportsImage
  imageId={playerId}
  imageType={ImageType.Players}
  size="xl"
  variant="circle"
/>
```

### ì°¸ê³  ì»´í¬ë„ŒíŠ¸
- `PlayerStatsModal.tsx` - ì„ ìˆ˜ ì´ë¯¸ì§€ + íŒ€ ë¡œê³  ë±ƒì§€ ìŠ¤íƒ€ì¼
- `PlayerHeader.tsx` - ì„ ìˆ˜ í”„ë¡œí•„ í—¤ë” ìŠ¤íƒ€ì¼

---

## ê´€ë ¨ ë¬¸ì„œ

- [ê²½ê¸° ì¹´ë“œ ì‹œìŠ¤í…œ](../hot-system/score-calculation.md)
- [ì—ë””í„° í™•ì¥ ê°€ì´ë“œ](./editor-extensions.md)





  /ìƒˆë¡œí•œê±° 
  
ë§¤ì¹˜ì¹´ë“œ vs ì„ ìˆ˜ì¹´ë“œ/íŒ€ì¹´ë“œ UI ì°¨ì´ì  ë¶„ì„

  ìŠ¤í¬ë¦°ìƒ·ê³¼ ì½”ë“œë¥¼ ë¹„êµ ë¶„ì„í•œ ê²°ê³¼ì…ë‹ˆë‹¤. ë§¤ì¹˜ì¹´ë“œ ê¸°ì¤€ìœ¼ë¡œ ì„ ìˆ˜/íŒ€ì¹´ë“œì™€ì˜ ì°¨ì´ì ì„ ì •ë¦¬í–ˆìŠµë‹ˆ ë‹¤.

  ---
  1. ë ˆì´ì•„ì›ƒ (Display)

  | ì†ì„±           | ë§¤ì¹˜ì¹´ë“œ        | ì„ ìˆ˜ì¹´ë“œ/íŒ€ì¹´ë“œ         |
  |----------------|-----------------|-------------------------|
  | display        | block (ê¸°ë³¸ê°’)  | inline-block            |
  | vertical-align | ì—†ìŒ            | top                     |
  | min-width      | ì—†ìŒ            | 100px                   |
  | margin         | 1rem 0 (ìƒí•˜ë§Œ) | 0.5rem + margin-left: 0 |

  ê²°ê³¼: ë§¤ì¹˜ì¹´ë“œëŠ” ì „ì²´ ë„ˆë¹„, ì„ ìˆ˜/íŒ€ì¹´ë“œëŠ” ì¸ë¼ì¸ìœ¼ë¡œ ë‚˜ë€íˆ ë°°ì¹˜ë¨

  ---
  2. ë©”ì¸ ì˜ì—­ êµ¬ì¡°

  | êµ¬ë¶„            | ë§¤ì¹˜ì¹´ë“œ (.match-main)                          | ì„ ìˆ˜/íŒ€ì¹´ë“œ (.player-main,
 .team-main) |
  |-----------------|-------------------------------------------------|----------------------------------------|
  | flex-direction  | row (ê¸°ë³¸ê°’)                                    | column                    
             |
  | justify-content | space-between                                   | ì—†ìŒ                      
             |
  | padding         | 0.75rem                                         | 0.75rem 1rem              
             |
  | êµ¬ì¡°            | í™ˆíŒ€(40%) - ìŠ¤ì½”ì–´(20%) - ì›ì •íŒ€(40%) ê°€ë¡œ ë°°ì¹˜ | ì´ë¯¸ì§€ â†’ ì´ë¦„ ì„¸ë¡œ ë°°ì¹˜                |

  ---
  3. ì´ë¯¸ì§€/ë¡œê³  í¬ê¸°

  | êµ¬ë¶„         | ë§¤ì¹˜ì¹´ë“œ                            | ì„ ìˆ˜/íŒ€ì¹´ë“œ                              
       |
  |--------------|-------------------------------------|-------------------------------------------------|
  | íŒ€/ì„ ìˆ˜ ë¡œê³  | .team-logo: 3rem (48px), CSS í´ë˜ìŠ¤ | ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ max-width: 48px; max-height: 48px |
  | ì„ ìˆ˜ ì‚¬ì§„    | ì—†ìŒ                                | .player-photo: 48px, border-radius: 50%         |
  | ë¦¬ê·¸ ë¡œê³     | 1.5rem (24px)                       | 1.5rem (24px) - ë™ì¼                     
       |

  ---
  4. ë‹¤í¬ëª¨ë“œ ì´ë¯¸ì§€ ì „í™˜ âš ï¸ í•µì‹¬ ì°¨ì´

  | êµ¬ë¶„          | ë§¤ì¹˜ì¹´ë“œ                           | ì„ ìˆ˜ì¹´ë“œ/íŒ€ì¹´ë“œ |
  |---------------|------------------------------------|-----------------|
  | data ì†ì„±     | data-light-src, data-dark-src ìˆìŒ | ì—†ìŒ            |
  | ë‹¤í¬ëª¨ë“œ ì „í™˜ | ì§€ì›ë¨ (JSë¡œ ì´ë¯¸ì§€ URL êµì²´)      | ë¯¸ì§€ì›          |

  ë§¤ì¹˜ì¹´ë“œ (matchCard.ts:313-330):
  <img src="${leagueImages.light}"
       data-light-src="${leagueImages.light}"
       data-dark-src="${leagueImages.dark}" ... />

  íŒ€ì¹´ë“œ (teamCardRenderer.ts:43-51):
  <img src="${leagueLogoUrl}" class="league-logo" ... />
  <!-- data-*-src ì†ì„± ì—†ìŒ -->

  ---
  5. ì´ë¦„ í‘œì‹œ ì¤„ ìˆ˜

  | êµ¬ë¶„               | ë§¤ì¹˜ì¹´ë“œ    | ì„ ìˆ˜/íŒ€ì¹´ë“œ |
  |--------------------|-------------|-------------|
  | -webkit-line-clamp | 2 (2ì¤„ê¹Œì§€) | 1 (1ì¤„ê¹Œì§€) |
  | margin-top         | ì—†ìŒ        | 0.5rem      |

  ---
  6. í—¤ë” ë‚´ìš©

  | êµ¬ë¶„     | í—¤ë” ë‚´ìš©              |
  |----------|------------------------|
  | ë§¤ì¹˜ì¹´ë“œ | ë¦¬ê·¸ ë¡œê³  + ë¦¬ê·¸ëª…     |
  | íŒ€ì¹´ë“œ   | ë¦¬ê·¸ ë¡œê³  + ë¦¬ê·¸ëª…     |
  | ì„ ìˆ˜ì¹´ë“œ | íŒ€ ë¡œê³  + íŒ€ëª… (ë‹¤ë¦„!) |

  ---
  7. ì•µì»¤ íƒœê·¸ ìŠ¤íƒ€ì¼

  | êµ¬ë¶„            | ë§¤ì¹˜ì¹´ë“œ | ì„ ìˆ˜/íŒ€ì¹´ë“œ        |
  |-----------------|----------|--------------------|
  | text-decoration | none     | none !important    |
  | color           | inherit  | inherit !important |

  ---
  8. í‘¸í„° ë§í¬ í…ìŠ¤íŠ¸

  | ì¹´ë“œ     | í…ìŠ¤íŠ¸           |
  |----------|------------------|
  | ë§¤ì¹˜ì¹´ë“œ | "ë§¤ì¹˜ ìƒì„¸ ì •ë³´" |
  | íŒ€ì¹´ë“œ   | "íŒ€ ì •ë³´ í™•ì¸"   |
  | ì„ ìˆ˜ì¹´ë“œ | "ì„ ìˆ˜ ì •ë³´ í™•ì¸" |

  ---
  9. HTML êµ¬ì¡° ì°¨ì´ ìš”ì•½

  ë§¤ì¹˜ì¹´ë“œ:
  .match-card
  â””â”€â”€ a (href="/livescore/football/match/{id}")
      â”œâ”€â”€ .league-header
      â”‚   â””â”€â”€ div (flex)
      â”‚       â”œâ”€â”€ img.league-logo (data-light-src, data-dark-src)
      â”‚       â””â”€â”€ span.league-name
      â”œâ”€â”€ .match-main
      â”‚   â”œâ”€â”€ .team-info (40%)
      â”‚   â”‚   â”œâ”€â”€ img.team-logo (data-light-src, data-dark-src)
      â”‚   â”‚   â””â”€â”€ span.team-name
      â”‚   â”œâ”€â”€ .score-area (20%)
      â”‚   â”‚   â”œâ”€â”€ .score > .score-number + .score-separator + .score-number
      â”‚   â”‚   â””â”€â”€ .match-status
      â”‚   â””â”€â”€ .team-info (40%)
      â””â”€â”€ .match-footer > .footer-link

  ì„ ìˆ˜ì¹´ë“œ:
  .player-card
  â””â”€â”€ a (href="/livescore/football/player/{id}")
      â”œâ”€â”€ .league-header
      â”‚   â””â”€â”€ div (inline style)
      â”‚       â”œâ”€â”€ img.league-logo (data ì†ì„± ì—†ìŒ)
      â”‚       â””â”€â”€ span.league-name
      â”œâ”€â”€ .player-main
      â”‚   â”œâ”€â”€ .player-photo > img (inline style)
      â”‚   â””â”€â”€ span.player-name
      â””â”€â”€ .match-footer > .footer-link

  íŒ€ì¹´ë“œ:
  .team-card
  â””â”€â”€ a (href="/livescore/football/team/{id}")
      â”œâ”€â”€ .league-header
      â”‚   â””â”€â”€ div (inline style)
      â”‚       â”œâ”€â”€ img.league-logo (data ì†ì„± ì—†ìŒ)
      â”‚       â””â”€â”€ span.league-name
      â”œâ”€â”€ .team-main
      â”‚   â”œâ”€â”€ div (inline style wrapper) > img (inline style)
      â”‚   â””â”€â”€ span.team-name
      â””â”€â”€ .match-footer > .footer-link

  ---
  10. ì½”ë“œ íŒŒì¼ë³„ ìœ„ì¹˜

  | íŒŒì¼                        | ê´€ë ¨ ë‚´ìš©                            |
  |-----------------------------|--------------------------------------|
  | globals.css:524-695         | ë§¤ì¹˜ì¹´ë“œ CSS                         |
  | globals.css:1135-1316       | ì„ ìˆ˜/íŒ€ì¹´ë“œ CSS                      |
  | matchCard.ts:251-366        | ë§¤ì¹˜ì¹´ë“œ HTML ìƒì„± (data-*-src í¬í•¨) |
  | playerCardRenderer.ts:32-78 | ì„ ìˆ˜ì¹´ë“œ HTML ìƒì„± (data-*-src ì—†ìŒ) |
  | teamCardRenderer.ts:28-75   | íŒ€ì¹´ë“œ HTML ìƒì„± (data-*-src ì—†ìŒ)   |

  ---
  ê²°ë¡ : ì£¼ìš” ë¶ˆì¼ì¹˜ ì‚¬í•­

  1. ë‹¤í¬ëª¨ë“œ ì´ë¯¸ì§€ ì „í™˜: ë§¤ì¹˜ì¹´ë“œë§Œ ì§€ì›, ì„ ìˆ˜/íŒ€ì¹´ë“œ ë¯¸ì§€ì›
  2. ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼: ë§¤ì¹˜ì¹´ë“œëŠ” CSS í´ë˜ìŠ¤, ì„ ìˆ˜/íŒ€ì¹´ë“œëŠ” ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ í˜¼ìš©
  3. ë ˆì´ì•„ì›ƒ ë°©ì‹: ë§¤ì¹˜ì¹´ë“œëŠ” block/row, ì„ ìˆ˜/íŒ€ì¹´ë“œëŠ” inline-block/column
